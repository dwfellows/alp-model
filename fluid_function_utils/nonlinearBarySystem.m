function F = nonlinearBarySystem(xi,xn,xf)

  F(1) = xf(1) - ( xn(1,1)*(1-2*xi(1)-2*xi(2)-2*xi(3))*(1-xi(1)-xi(2)-xi(3)) + xn(2,1)*(2*xi(1)-1)*xi(1) + xn(3,1)*(2*xi(2)-1)*xi(2) + xn(4,1)*(2*xi(3)-1)*xi(3) ...
            + 4*xn(5,1)*(1-xi(1)-xi(2)-xi(3))*xi(1) + 4*xn(6,1)*xi(1)*xi(2) + 4*xn(7,1)*(1-xi(1)-xi(2)-xi(3))*xi(2) ...
            + 4*xn(8,1)*(1-xi(1)-xi(2)-xi(3))*xi(3) + 4*xn(9,1)*xi(1)*xi(3) + 4*xn(10,1)*xi(2)*xi(3) );

%  F(2) = xf(2) - ( xn(1,2)*(1-2*xi(1)-2*xi(2)-2*xi(3))*(1-xi(1)-xi(2)-xi(3)) + xn(2,2)*(2*xi(1)-1)*xi(1) + xn(3,2)*(2*xi(2)-1)*xi(2) + xn(4,2)*(2*xi(3)-1)*xi(3) ...
%            + 4*xn(5,2)*(1-xi(1)-xi(2)-xi(3))*xi(1) + 4*xn(6,2)*xi(1)*xi(2) + 4*xn(7,2)*(1-xi(1)-xi(2)-xi(3))*xi(2) ...
%            + 4*xn(8,2)*(1-xi(1)-xi(2)-xi(3))*xi(3) + 4*xn(9,2)*xi(1)*xi(3) + 4*xn(10,2)*xi(2)*xi(3) );
%
%  F(3) = xf(3) - ( xn(1,3)*(1-2*xi(1)-2*xi(2)-2*xi(3))*(1-xi(1)-xi(2)-xi(3)) + xn(2,3)*(2*xi(1)-1)*xi(1) + xn(3,3)*(2*xi(2)-1)*xi(2) + xn(4,3)*(2*xi(3)-1)*xi(3) ...
%            + 4*xn(5,3)*(1-xi(1)-xi(2)-xi(3))*xi(1) + 4*xn(6,3)*xi(1)*xi(2) + 4*xn(7,3)*(1-xi(1)-xi(2)-xi(3))*xi(2) ...
%            + 4*xn(8,3)*(1-xi(1)-xi(2)-xi(3))*xi(3) + 4*xn(9,3)*xi(1)*xi(3) + 4*xn(10,3)*xi(2)*xi(3) );

  F(2) = xf(2) - ( xn(1,2)*(1-2*xi(1)-2*xi(2)-2*xi(3))*(1-xi(1)-xi(2)-xi(3)) + xn(2,2)*(2*xi(1)-1)*xi(1) + xn(3,2)*(2*xi(2)-1)*xi(2) + xn(4,2)*(2*xi(3)-1)*xi(3) ...
            + 4*xn(5,2)*(1-xi(1)-xi(2)-xi(3))*xi(1) + 4*xn(6,2)*xi(1)*xi(2) + 4*xn(7,2)*(1-xi(1)-xi(2)-xi(3))*xi(2) ...
            + 4*xn(8,2)*(1-xi(1)-xi(2)-xi(3))*xi(3) + 4*xn(9,2)*xi(1)*xi(3) + 4*xn(10,2)*xi(2)*xi(3) );

  F(3) = xf(3) - ( xn(1,3)*(1-2*xi(1)-2*xi(2)-2*xi(3))*(1-xi(1)-xi(2)-xi(3)) + xn(2,3)*(2*xi(1)-1)*xi(1) + xn(3,3)*(2*xi(2)-1)*xi(2) + xn(4,3)*(2*xi(3)-1)*xi(3) ...
            + 4*xn(5,3)*(1-xi(1)-xi(2)-xi(3))*xi(1) + 4*xn(6,3)*xi(1)*xi(2) + 4*xn(7,3)*(1-xi(1)-xi(2)-xi(3))*xi(2) ...
            + 4*xn(8,3)*(1-xi(1)-xi(2)-xi(3))*xi(3) + 4*xn(9,3)*xi(1)*xi(3) + 4*xn(10,3)*xi(2)*xi(3) );


end
